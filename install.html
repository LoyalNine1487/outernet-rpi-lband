

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Software installation &mdash; Outernet L-band on Rasbian 1.0.dev1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Outernet L-band on Rasbian 1.0.dev1 documentation" href="index.html"/>
        <link rel="next" title="Running the software stack" href="running.html"/>
        <link rel="prev" title="Introduction" href="intro.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Outernet L-band on Rasbian
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="requirements.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Software installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#preparing-the-device">Preparing the device</a></li>
<li class="toctree-l2"><a class="reference internal" href="#download-locations">Download locations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#switching-to-raspbian-testing">Switching to Raspbian testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing-dependencies">Installing dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuring-postgres">Configuring postgres</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing-the-outernet-software">Installing the Outernet software</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing-ondd">Installing ONDD</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing-starsdr-and-l-band-demodulator">Installing StarSDR and L-band demodulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing-librarian-user-interface">Installing Librarian user interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-the-librarian-configuration-file">Creating the Librarian configuration file</a></li>
<li class="toctree-l2"><a class="reference internal" href="#add-the-version-file">Add the version file</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="running.html">Running the software stack</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Outernet L-band on Rasbian</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Software installation</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/install.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="software-installation">
<h1>Software installation<a class="headerlink" href="#software-installation" title="Permalink to this headline">¶</a></h1>
<p>In this section, we will install all the necessary software and ensure the
system is prepared to run it. The next section will discuss the programs&#8217;
usage.</p>
<div class="section" id="preparing-the-device">
<h2>Preparing the device<a class="headerlink" href="#preparing-the-device" title="Permalink to this headline">¶</a></h2>
<p>Connect your Raspberry Pi to a router either using WiFi (Raspberry Pi 3) or LAN
cable (all versions). Also plug in the SDR radio, and attach the LNA and
antenna to it. If you want to use a keyboard and a monitor, hook those up as
well.</p>
</div>
<div class="section" id="download-locations">
<h2>Download locations<a class="headerlink" href="#download-locations" title="Permalink to this headline">¶</a></h2>
<p>Before we begin, we need to decide on where to put the downloaded files. There
are two directories where files will be stored:</p>
<ul class="simple">
<li>temporary cache directory for unfinished downloads</li>
<li>permanent directory for finished downloads</li>
</ul>
<p>In this guide, we will use <code class="docutils literal"><span class="pre">/var/spool/ondd</span></code> for temporary download cache,
and <code class="docutils literal"><span class="pre">/srv/downloads</span></code> for finished downloads. Whether you go with these or
some other locations, it is recommended you write them down for future
reference.</p>
<p>Let&#8217;s create the download locations:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ sudo mkdir -p /var/spool/ondd /srv/downloads
</pre></div>
</div>
</div>
<div class="section" id="switching-to-raspbian-testing">
<h2>Switching to Raspbian testing<a class="headerlink" href="#switching-to-raspbian-testing" title="Permalink to this headline">¶</a></h2>
<p>Your Raspbian install is going to be &#8216;upgraded&#8217; to the testing repository. If
you are not sure this is a good idea (or you know it is not), we recommend
creating an SD card specifically for running the Outernet software, rather than
modifying your existing cards.</p>
<p>To upgrade to Raspbian testing, we will run the following commands:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ cat /etc/apt/sources.list | sed &#39;s/jessie/testing/&#39; | sudo tee /etc/apt/sources.list.d/testing.list
$ sudo apt-get update
$ sudo apt-get upgrade
</pre></div>
</div>
<p>It is a good idea to reboot once after the previous steps.</p>
</div>
<div class="section" id="installing-dependencies">
<h2>Installing dependencies<a class="headerlink" href="#installing-dependencies" title="Permalink to this headline">¶</a></h2>
<p>Apart from the software mentioned in the :doc:intro section, we also need a few
of the usual Raspbian packages that these programs depend on.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ sudo apt-get install postgresql libev-dev libpq-dev python-dev build-essential screen libusb-1.0
</pre></div>
</div>
<p>Due to a bug in the <code class="docutils literal"><span class="pre">python-distlib</span></code>, this package needs to be downgraded. To
do this, run:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ wget http://ftp.debian.org/debian/pool/main/d/distlib/python-distlib_0.1.9-1_all.deb
$ wget http://ftp.debian.org/debian/pool/main/d/distlib/python-distlib-whl_0.1.9-1_all.deb
$ sudo dpkg -i *.deb
</pre></div>
</div>
</div>
<div class="section" id="configuring-postgres">
<h2>Configuring postgres<a class="headerlink" href="#configuring-postgres" title="Permalink to this headline">¶</a></h2>
<p>Raspbian&#8217;s PostgreSQL package, by default, enforces stricter access control.
For the quick set-up we are doing, we will need to loosen it up a little. Edit
the file named <code class="docutils literal"><span class="pre">/etc/postgresql/9.5/main/pg_hba.conf</span></code> and find the lines that
start with <code class="docutils literal"><span class="pre">host</span></code> and end in <code class="docutils literal"><span class="pre">md5</span></code>. Change the <code class="docutils literal"><span class="pre">md5</span></code> portion to
<code class="docutils literal"><span class="pre">trust</span></code>.  This causes all connections coming from within the Raspberry Pi to
be treated as trusted connection. Once the configuration is modified, we need
to restart the database server:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ sudo service postgresql restart
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This PosgreSQL configuration is unsafe if you ware exposing Raspberry Pi to
the Internet with its default SSH username and password.</p>
</div>
</div>
<div class="section" id="installing-the-outernet-software">
<h2>Installing the Outernet software<a class="headerlink" href="#installing-the-outernet-software" title="Permalink to this headline">¶</a></h2>
<p>Now we are ready to install the Outernet software. All necessary software is
located in the Outernet&#8217;s source repository at <a class="reference external" href="https://archive.outernet.is/sources/">archive.outernet.is/sources/</a> (even though some of the software are
not source tarballs).</p>
</div>
<div class="section" id="installing-ondd">
<h2>Installing ONDD<a class="headerlink" href="#installing-ondd" title="Permalink to this headline">¶</a></h2>
<p>To install ONDD:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ wget https://archive.outernet.is/sources/ondd-rpi3-armhf-2.2.0.tar.gz
$ tar xvf ondd-rpi3-armhf-2.2.0.tar.gz
$ cd ondd-rpi3-armhf-2.2.0
</pre></div>
</div>
<p>Before installing, please review the license file found in the unpacked
directory and make sure you find it agreeable. To complete the install:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ sudo make install
</pre></div>
</div>
<p>ONDD license is found in the <code class="docutils literal"><span class="pre">/usr/local/share/doc/ondd/LICENSE.txt</span></code>.</p>
</div>
<div class="section" id="installing-starsdr-and-l-band-demodulator">
<h2>Installing StarSDR and L-band demodulator<a class="headerlink" href="#installing-starsdr-and-l-band-demodulator" title="Permalink to this headline">¶</a></h2>
<p>To install the StarSDR library and the demodulator program:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ wget https://archive.outernet.is/sources/starsdr-rpi3-armhf-2.0.tar.gz
$ tar xvf starsdr-rpi3-armhf-2.0.tar.gz
$ cd starsdr-rpi3-armhf-2.0
</pre></div>
</div>
<p>Before installing, please review the license file found in the unpacked
directory and make sure you find it agreeable. To complete the install:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ sudo make install
</pre></div>
</div>
</div>
<div class="section" id="installing-librarian-user-interface">
<h2>Installing Librarian user interface<a class="headerlink" href="#installing-librarian-user-interface" title="Permalink to this headline">¶</a></h2>
<p>The Librarian user interface is a Python application, and is therefore
installed using <code class="docutils literal"><span class="pre">pip</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ sudo pip install --extra-index-url https://archive.outernet.is/sources/pypi/simple/ https://github.com/Outernet-Project/librarian/archive/v4.0.post1.tar.gz
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Some of the packages will require C extensions, so expect the installation
to take a while.</p>
</div>
</div>
<div class="section" id="creating-the-librarian-configuration-file">
<h2>Creating the Librarian configuration file<a class="headerlink" href="#creating-the-librarian-configuration-file" title="Permalink to this headline">¶</a></h2>
<p>Librarian must be configured before it can run with our set-up. To do this
create and edit a file /etc/librarian.ini (it can be anywhere as long as your
remember the location and adjust the example commands accordingly):</p>
<div class="highlight-'ini'"><div class="highlight"><pre><span></span>[config]

defaults =
    /usr/local/lib/python2.7/dist-packages/librarian/config.ini

[app]

debug = no
bind = 0.0.0.0
port = 80
default_route = filemanager:list
default_route_args =
    path:

[ondd]

band = l
demod_restart_command = echo &#39;noop&#39;

[lock]

file = /var/run/librarian.lock

[platform]

name = rpi3
version_file = /etc/version

[logging]

output = /var/log/librarian.log
syslog = /var/log/messages
size = 5M
backups = 2
fsal_log = /var/log/fsal.log

[setup]

file = /srv/librarian/librarian.json

[mako]

module_directory = /tmp/mako_cache

[fsal]

socket = /var/run/fsal.ctrl

[menu]

main =
    files

[cache]

backend = in-memory
timeout = 100
</pre></div>
</div>
<p>We also need to create the FSAL (filesystem indexer) configuration. Create and
edit a file called /etc/fsal.ini:</p>
<div class="highlight-'ini'"><div class="highlight"><pre><span></span>[config]

defaults =
    /usr/lib/python2.7/site-packages/fsal/fsal-server.ini

[fsal]

# Adjust this as needed
basepaths =
  /srv/downloads

socket = /var/run/fsal.ctrl

# Folders that are blacklisted
+blacklist =
  ^.platform(/.*)?$
  ^(.*/)?.thumbs(/.*)?$
  ^updates(/.*)?$
  ^legacy(/.*)?$
  ^FSCK.*.REC$

[logging]

output = /var/log/fsal.log
size = 5M
backups = 2
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The example <a class="reference download internal" href="_downloads/librarian.ini" download=""><code class="xref download docutils literal"><span class="pre">librarian.ini</span></code></a> and
<a class="reference download internal" href="_downloads/fsal.ini" download=""><code class="xref download docutils literal"><span class="pre">fsal.ini</span></code></a> are provided for convenience.</p>
</div>
</div>
<div class="section" id="add-the-version-file">
<h2>Add the version file<a class="headerlink" href="#add-the-version-file" title="Permalink to this headline">¶</a></h2>
<p>Although not strictly required, we will add a version file for completeness.
Note the version in the table at the start of this guide and echo that version
into the version file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ echo &#39;VERSION&#39; | sudo tee /etc/version
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="running.html" class="btn btn-neutral float-right" title="Running the software stack" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="intro.html" class="btn btn-neutral" title="Introduction" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Outernet Inc &lt;apps@outernet.is&gt;.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0.dev1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>